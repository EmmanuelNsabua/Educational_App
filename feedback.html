<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Résultats du Quiz</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        .result-card.correct { border-left: 4px solid #10b981; }
        .result-card.incorrect { border-left: 4px solid #ef4444; }
        .progress-bar { transition: width 1s ease-in-out; }
    </style>
</head>
<body class="bg-gray-50">
    <div class="container mx-auto px-4 py-8 max-w-3xl">
        <div class="bg-white rounded-xl shadow-md overflow-hidden">
            <!-- En-tête -->
            <div class="bg-blue-600 text-white p-6 text-center">
                <h1 class="text-2xl font-bold">Résultats du Quiz</h1>
                <p id="result-date" class="text-blue-100 mt-1"></p>
            </div>

            <!-- Score Principal -->
            <div class="p-6 text-center border-b">
                <div class="inline-block relative w-32 h-32 mb-4">
                    <svg class="w-full h-full" viewBox="0 0 36 36">
                        <path d="M18 2.0845
                            a 15.9155 15.9155 0 0 1 0 31.831
                            a 15.9155 15.9155 0 0 1 0 -31.831"
                            fill="none" stroke="#e6e6e6" stroke-width="3"/>
                        <path id="result-circle" d="M18 2.0845
                            a 15.9155 15.9155 0 0 1 0 31.831
                            a 15.9155 15.9155 0 0 1 0 -31.831"
                            fill="none" stroke="#3b82f6" stroke-width="3"
                            stroke-dasharray="0 100"/>
                    </svg>
                    <div class="absolute inset-0 flex items-center justify-center">
                        <span id="result-percentage" class="text-2xl font-bold">0%</span>
                    </div>
                    </div>
                    <h2 id="result-score" class="text-2xl font-bold mb-2">0/0</h2>
                    <p id="result-message" class="text-lg"></p>
                </div>

                <!-- Détail des Réponses -->
                <div class="p-6">
                    <h3 class="text-xl font-semibold mb-4">Détail des réponses</h3>
                    <div id="results-container" class="space-y-4">
                        <!-- Les résultats seront insérés ici -->
                    </div>
                </div>

                <!-- Actions -->
                <div class="p-6 bg-gray-50 flex justify-between">
                    <a href="index.html" class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300">
                        <i class="fas fa-book-open mr-2"></i>Retour aux révisions
                    </a>
                    <a href="quiz.html" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">
                        <i class="fas fa-redo mr-2"></i>Refaire le quiz
                    </a>
                </div>
            </div>
        </div>

        <script>
            document.addEventListener('DOMContentLoaded', () => {
                const results = JSON.parse(localStorage.getItem('quizResults'));
                if (!results) {
                    window.location.href = 'quiz.html';
                    return;
                }

                const percentage = Math.round((results.score / results.total) * 100);
                
                // Affichage des résultats principaux
                document.getElementById('result-score').textContent = `${results.score}/${results.total}`;
                document.getElementById('result-percentage').textContent = `${percentage}%`;
                document.getElementById('result-date').textContent = new Date(results.date).toLocaleString();
                
                // Animation du cercle de progression
                const circle = document.getElementById('result-circle');
                const circumference = 2 * Math.PI * 15.9155;
                circle.style.strokeDasharray = `${circumference}`;
                circle.style.strokeDashoffset = `${circumference - (percentage / 100) * circumference}`;
                
                // Message d'appréciation
                const messageEl = document.getElementById('result-message');
                if (percentage >= 90) {
                    messageEl.textContent = "Excellent! Vous maîtrisez parfaitement le sujet.";
                    messageEl.className = "text-lg text-green-600";
                } else if (percentage >= 70) {
                    messageEl.textContent = "Très bien! Vous avez une bonne compréhension.";
                    messageEl.className = "text-lg text-blue-600";
                } else if (percentage >= 50) {
                    messageEl.textContent = "Pas mal! Quelques révisions seraient bénéfiques.";
                    messageEl.className = "text-lg text-yellow-600";
                } else {
                    messageEl.textContent = "À revoir! Consultez les révisions avant de recommencer.";
                    messageEl.className = "text-lg text-red-600";
                }
                
                // Détail des réponses
                const container = document.getElementById('results-container');
                results.answers.forEach((answer, index) => {
                    const card = document.createElement('div');
                    card.className = `result-card p-4 bg-white rounded-lg shadow-sm ${answer.isCorrect ? 'correct' : 'incorrect'}`;
                    card.innerHTML = `
                        <div class="font-semibold mb-2">Question ${index + 1}: ${answer.question}</div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-2">
                            <div class="${answer.isCorrect ? 'text-green-600' : 'text-red-600'}">
                                <i class="fas ${answer.isCorrect ? 'fa-check-circle' : 'fa-times-circle'} mr-1"></i>
                                Votre réponse: ${answer.userAnswer || 'Aucune'}
                            </div>
                            <div class="text-gray-700">
                                <i class="fas fa-lightbulb mr-1"></i>
                                Réponse correcte: ${answer.correctAnswer}
                            </div>
                        </div>
                    `;
                    container.appendChild(card);
                });
            });
        </script>
    </body>
</html>